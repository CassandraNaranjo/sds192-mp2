---
title: "Mini-Project 2"
authors: "Amelia Stapleton and Cassie Naranjo"
date: "2019-03-24"
output: 
  html_document:
    code_folding: show
---

## Loading the data
```{r message = FALSE, echo = FALSE}
library(tidyverse)
library(dplyr)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

> Word count: `r wordcountaddin::word_count()`

##Filtering out what we want from candidates data.frame
```{r}
new_c <- candidates %>%
  filter(cand_election_yr == "2012") %>%
  select(cand_id,cand_election_yr)
```

##Filtering out what we want from house_elections data.frame and mutating to create a common variable
```{r}
new_h_e <- house_elections %>%
  filter(incumbent == "TRUE") %>%
  mutate(cand_id = fec_id) %>%
  select(cand_id, candidate_name, state, incumbent, party, ge_winner)
```

##BRB attempting to join
```{r}
MP2_table <- new_h_e %>%
  inner_join(new_c, by = c("cand_id" = "cand_id"))
```

##Filtering for states
##California
```{r}
cand_CA <- MP2_table %>%
  filter(state == "CA") %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
```

##New York
```{r}
cand_NY <- MP2_table %>%
<<<<<<< HEAD
  filter(state == "NY")

num_NY <- cand_NY %>%
  group_by(party, ge_winner) %>%
  summarize(N = n()) 
=======
  filter(state == "NY") %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
>>>>>>> fde771d003406f8193c6650b4294fa119e924055
```

##Texas
```{r}
cand_TX <- MP2_table %>%
<<<<<<< HEAD
  filter(state == "TX")

num_TX <- cand_TX %>%
  group_by(party, ge_winner) %>%
  summarize(N = n()) 
=======
  filter(state == "TX") %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
>>>>>>> fde771d003406f8193c6650b4294fa119e924055
```

##Florida
```{r}
cand_FL <- MP2_table %>%
  filter(state == "FL") %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
```
###Making some graphics

```{r}
ggplot(data = cand_CA, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack") 
```

<<<<<<< HEAD
num_FL <- cand_FL %>%
  group_by(party, ge_winner) %>%
  summarize(N = n()) 
```

###Making some graphics
```{r}
ggplot(data = num_CA, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack")
```

```{r}
ggplot(data = num_NY, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack")

```

```{r}
ggplot(data = num_TX, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack")
```

```{r}
ggplot(data = num_FL, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack")
```

=
###Trying to create a function for tables 
```{r message = FALSE, echo = FALSE}
table_function <- function(state_arg) {
  MP2_table %>%
     filter(state == state_arg) %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
}
```

```{r message = FALSE, echo = FALSE}
plot_CA <- table_function(state_arg = "CA")
plot_NY <- table_function(state_arg = "NY")
plot_TX <- table_function(state_arg = "TX")
plot_FL <- table_function(state_arg = "FL")
```

###Trying to create a function for graphics 
```{r}
plot_function <- function(data_arg) {
  ggplot(data = data_arg, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack") 
}
```

```{r}
plot_function(data_arg = plot_CA)
plot_function(data_arg = plot_NY)
plot_function(data_arg = plot_TX)
plot_function(data_arg = plot_FL)
```

