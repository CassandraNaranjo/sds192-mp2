---
title: "Mini-Project 2"
authors: "Amelia Stapleton and Cassie Naranjo"
date: "2019-03-24"
output: 
  html_document:
    code_folding: show
---

## Loading the data
```{r message = FALSE, echo = FALSE}
library(tidyverse)
library(dplyr)
library(ggthemes)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

> Word count: `r wordcountaddin::word_count()`

##Filtering out what we want from candidates data.frame
```{r}
new_c <- candidates %>%
  filter(cand_election_yr == "2012") %>%
  select(cand_id,cand_election_yr)
```

##Filtering out what we want from house_elections data.frame
##Mutating to create a common variable
```{r}
new_h_e <- house_elections %>%
  filter(incumbent == "TRUE") %>%
  mutate(cand_id = fec_id) %>%
  select(cand_id, candidate_name, state, incumbent, party, ge_winner)
```

##BRB attempting to join
```{r}
MP2_table <- new_h_e %>%
  inner_join(new_c, by = c("cand_id" = "cand_id"))
```

###Creating a function for tables 
```{r message = FALSE, echo = FALSE}
table_function <- function(state_arg) {
  MP2_table %>%
     filter(state == state_arg) %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
}
```

```{r message = FALSE, echo = FALSE}
plot_CA <- table_function(state_arg = "CA")
plot_NY <- table_function(state_arg = "NY")
plot_TX <- table_function(state_arg = "TX")
plot_FL <- table_function(state_arg = "FL")
```

```{r}
fill <- c("#b3cde3", "#fbb4ae")
```

###Trying to create a function for graphics 
```{r}
plot_function <- function(data_arg) {
  ggplot(data = data_arg, aes(x = party, y = N), fill = ge_winner) +
  geom_bar(stat = "identity", aes(fill = ge_winner),  position = "stack") +
  labs(y = "Number of Incumbent Candidates", x = "Political Party") +
  scale_fill_manual("Legend", values = c("N" = "blue", "W" = "red")) +
  scale_x_discrete(breaks = c("D", "R"), labels = c("Democratic", "Republican")) +
  ggthemes::theme_tufte(plot.title = element_text(size = 25, face = "bold"),
          axis.ticks.length = (unit(.40, "cm")),
          axis.text = element_text(size = 18, color = "black"))
}
```

##Creating the graphics
```{r}
plot_function(data_arg = plot_CA) +
  labs(title = "How Likely is a Candidate from California To Be Reelected?")

plot_function(data_arg = plot_NY) +
  labs(title = "How Likely is a Candidate from New York To Be Reelected?")

plot_function(data_arg = plot_TX) +
  labs(title = "How Likely is a Candidate from Texas To Be Reelected?")

plot_function(data_arg = plot_FL) +
  labs(title = "How Likely is a Candidate from Florida To Be Reelected?")
```

