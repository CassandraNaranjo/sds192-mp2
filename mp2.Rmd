---
title: "Mini-Project 2"
author: "Amelia Stapleton and Cassie Naranjo"
<<<<<<< HEAD
date: "3/22/2019"
output: html_document
code_folding: show
=======
date: "2019-03-24"
output: 
  html_document:
    code_folding: show
>>>>>>> a44bc8bf1c9e51dab671b564494d9efd0a76dea9
---
Stuff left to do:
+2 for annotating your data wrangling pipeline (this can be in a few sentences in text surrounding the R code chunks, or some informative comments inside the R code chunks)
+2 for having at least 500 words and no more than 800 words (use the word count add-in in the template)
+1 for explaining in a single coherent sentence what we can learn from these data
+1 for providing context or background useful in interpreting the graphic
+1 for using a GitHub repository and including a link to it in the footnotes

<<<<<<< HEAD
```{r, message = FALSE, echo = FALSE, warning=FALSE}
=======
```{r, message = FALSE, echo = FALSE}
<<<<<<< HEAD
>>>>>>> a44bc8bf1c9e51dab671b564494d9efd0a76dea9
## Loading the data
=======
## Here we are loading the libraries and data from the FEC data set that we need to create our data graphic. We will use the tidyverse ggplot features, dplyr features to wrangle the data, ggthemes to make our graphic more aestheically pleasing, and RColorBrewer to load in specific colors into our graphic.

>>>>>>> 4b4e43bf81ff6c0c6e7609643c47b3e32a9f768a
library(tidyverse)
library(dplyr)
library(ggthemes)
library(RColorBrewer)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r, message = FALSE, echo = FALSE}
##This chunk of code serves to filter out the columns we want from candidates data set. We only want to look at the year 2012 so we are filtering out all the other years and we also need to select for the cand_id in order to create a common variable between this and another data set.


new_c <- candidates %>%
  filter(cand_election_yr == "2012") %>%
  select(cand_id,cand_election_yr)
```

```{r, message = FALSE, echo = FALSE}
## This chunk is filtering out what we want from house_elections data frame. We are only interested in the incumbent = TRUE data, along with the candidate_name, states, party, and whetehr or not the candidate was re-elected. We also needed to mutate cand_id to equal fec_id to create a common variable in order to join the datasets.

new_h_e <- house_elections %>%
  filter(incumbent == "TRUE") %>%
  mutate(cand_id = fec_id) %>%
  select(cand_id, candidate_name, state, incumbent, party, ge_winner)
```

```{r, message = FALSE, echo = FALSE}
##Here we are joining the two data frames we are interested in using the common variable of cand_id.


MP2_table <- new_h_e %>%
  inner_join(new_c, by = c("cand_id" = "cand_id"))
```

```{r message = FALSE, echo = FALSE}
##This chunk serves to create a function to generate tables for different states that will summarize the amount of candidates who were re-elected and who make up each party.


table_function <- function(state_arg) {
  MP2_table %>%
     filter(state == state_arg) %>%
  group_by(party, ge_winner) %>%
  summarize(N = n())
}
```

```{r, message = FALSE, echo = FALSE}
##Here we are plugging in different state arguments into our function to generate plots for each state.


plot_CA <- table_function(state_arg = "CA")
plot_NY <- table_function(state_arg = "NY")
plot_TX <- table_function(state_arg = "TX")
```

```{r, message = FALSE, echo = FALSE}
##This chunk is creating a function for each of our data graphics. We wanted to make a stacker bar graphic and have different colors represent democratic winners and losers as well as republican winners and losers.

plot_function <- function(data_arg) {
  ggplot(data = data_arg, aes(x = party, y = N, fill = interaction(party, ge_winner))) +
  geom_bar(stat = "identity", position = "stack") +
  labs(y = "Number of Incumbent Candidates", x = "Political Party") +
    scale_fill_manual(values = c("#9ecae1", "#fc9272", "#3182bd", "#de2d26"), name = "Condition", labels = c("Democratic Nonwinner", "Republican Nonwinner", "Democratic Winner", "Republican Winner"))+
  scale_x_discrete(breaks = c("D", "R"), labels = c("Democratic", "Republican")) +
  ggthemes::theme_tufte() +
  theme(plot.title = element_text(size=16.5, face='bold'),
axis.title.x = element_text(size =14), axis.title.y = element_text(size = 14), axis.ticks.length = (unit(.20, "cm")))
}

```


```{r}
##Here we are using the function to create the graphics for California, New York, and Texas. We also wanted to display the percentages of the winners for each party in each state data graphic to make the graphic easier to understand.

plot_function(data_arg = plot_CA) +
  labs(title = "How Likely is a Candidate from California To Be Re-Elected?") +
  annotate("text", x = 1, y = 15, label = "87%", color = "white", size = 8, fontface = 'bold') +
  annotate("text", x = 2, y =7, label = "80%", color = "white", size = 8, fontface = 'bold')

plot_function(data_arg = plot_NY) +
  labs(title = "How Likely is a Candidate from New York To Be Re-Elected?") +
  annotate("text", x = 1, y = 9, label = "94%", color = "white", size = 8, fontface = 'bold') +
  annotate("text", x = 2, y = 2.5, label = "71%", color = "white", size = 8, fontface = 'bold')

plot_function(data_arg = plot_TX) +
  labs(title = "How Likely is a Candidate from Texas To Be Re-Elected?") +
  annotate("text", x = 1, y = 4, label = "88%", color = "white", size = 8, fontface = 'bold') +
  annotate("text", x = 2, y = 12, label = "95%", color = "white", size = 8, fontface = 'bold')
```
